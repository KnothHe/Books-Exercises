$$
\begin{align}
a_{n+1} &= b_nq + a_nq + a_np = b_nq + a_n(p + q) \\
b_{n+1} &= b_np + a_nq \\
\end{align}
$$




$$
\begin{align}
a_{n+2} &= b_{n+1}q + a_{n+1}(p + q) \\
&= (b_np + a_nq)q + (b_nq + a_n(p+q))(p+q) \\
&= b_n(q^2+2pq) + a_n(2q^2 + 2pq + p^2) \\
b_{n+2} &= b_{n+1}p + a_{n+1}q \\
&= (b_np + a_nq)p + (b_nq + a_nq + a_np)q \\
&= b_n(p^2+q^2) + a_n(2pq + q^2) \\
\end{align}
$$



$$
\begin{align}
p' &= p^2 + q^2 \\
q' &= q^2 + 2pq \\
\end{align}
$$


